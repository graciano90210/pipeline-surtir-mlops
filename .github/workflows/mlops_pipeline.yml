name: Pipeline MLOps Surtir SAS

# Â¿CuÃ¡ndo se activa? Cada vez que empujamos cÃ³digo (push)
on:
  push:
    branches: [ "main" ]

jobs:
  entrenamiento-automatico:
    runs-on: ubuntu-latest

    steps:
    # 1. El robot descarga tu cÃ³digo
    - name: Chequear cÃ³digo del repositorio
      uses: actions/checkout@v3

    # 2. El robot instala Python
    - name: Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    # 3. El robot instala las librerÃ­as
    - name: Instalar dependencias
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 4. Â¡El robot ejecuta tu Pipeline!
    - name: Generar Datos, Entrenar y Subir Modelo
      env:
        # AquÃ­ el robot lee el secreto que guardamos
        AZURE_STORAGE_CONNECTION_STRING: ${{ secrets.AZURE_STORAGE_CONNECTION_STRING }}
      run: |
        echo "ðŸš€ Iniciando Pipeline AutomÃ¡tico..."
        python generate_data.py
        python train_model.py
        echo "âœ… Pipeline finalizado con Ã©xito."